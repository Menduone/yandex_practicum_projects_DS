# Определение стоимости автомобилей



## Описание проекта

Сервис по продаже автомобилей с пробегом `«***»` разрабатывает приложение, чтобы привлечь новых клиентов. В нём можно будет узнать рыночную стоимость своего автомобиля.

Нужно построить модель, которая умеет её определять. В нашем распоряжении данные о технических характеристиках, комплектации и ценах других автомобилей.


Также у нас установлены критерии, которые важны заказчику:
* качество предсказания;
* время обучения модели;
* время предсказания модели

Чтобы усилить исследование, мы не будем ограничивайтась только градиентным бустингом. Попробуем более простые модели — иногда они работают лучше. Эти редкие случаи легко пропустить, если всегда применять только бустинг.


Поэкспериментируем и сравним характеристики моделей: время обучения, время предсказания, точность результата.

---

## Стек/инструменты/библиотеки

```python
import pandas as pd
import matplotlib.pyplot as plt
import numpy as np
from sklearn.tree import DecisionTreeRegressor
from sklearn.ensemble import RandomForestRegressor
from sklearn.linear_model import LinearRegression
from sklearn.dummy import DummyRegressor
from catboost import CatBoostRegressor
from lightgbm import LGBMRegressor
from sklearn.model_selection import train_test_split, GridSearchCV
from sklearn.preprocessing import OrdinalEncoder, StandardScaler
from sklearn.metrics import mean_squared_error, make_scorer
```

---

## Итоги исследования

## Вывод

* Были загружены и разобраны данные;


* Были построены диаграммы размаха и гистограммы, с помощью который были обнаружены выбросы и аномальные значения, и впоследствии устранены;


* Были также удалены не нужные признаки для модели `'datecrawled', 'registrationmonth', 'datecreated', 'numberofpictures', 'postalcode', 'lastseen'`;


* Применили технику кодирования **OHE и OrdinalEncoder**;


* С помощью функции **tts** разделили датасеты на выборки, которые с помощью **StandardScaler** были приведены к **одному масштабу**;


* Была разработана функция расчета метрики качества **rmse**;


* Также была введена функция **best_model**, в которую была передана кастомная функция **rmse** как `score`. Также благодаря ей были рассчитаны **rmse** моделей и лушчие гиперпараметры для них при помощи **GridSearchCv**;


* В результате анализа моделей были выведены **топ 4 модели**: `DecisionTreeRegressor`, `RandomForestRegressor`, `CatBoostRegressor` и `LGBMRegressor`. Они были проверены на тестовых выборках;


* Была выявлена лучшая модель по критериям, которые важны заказчику (это качество предсказания, время обучения модели и время предсказания). Лучшей оказалась модель модель **CatBoostRegressor**, которая к тому же прошла тест на адекватность
